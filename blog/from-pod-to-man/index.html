<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="bits of blogging"><meta name="generator" content="Eleventy"><link rel="icon" href="/favicon.ico"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><title>From Pod to man pages</title><link rel="stylesheet" href="/jcrd.github.io/site.css"><link rel="stylesheet" href="/jcrd.github.io/prism-one-dark.css"></head><body class="flex flex-col min-h-screen mx-6 md:mx-auto my-auto max-w-2xl"><main class="flex-grow pt-6 md:pt-12"><div class="flex flex-col md-960:flex-row"><div class="mb-4 md-960:-ml-32 md-960:mr-8"><a href="https://twiddlingbits.net/"><img src="https://www.gravatar.com/avatar/6dd0c8e5214e4c4d0f0dafabebe82c3d?size=96"></a></div><div class="pt-4"><article class="space-y-24"><div class="flex flex-col"><h1 class="text-4xl font-bold">From Pod to man pages</h1><div class="flex gap-x-2 pt-1 text-gray-400"><div class="flex gap-x-1">Last updated: <span class="italic">Jan 30, 2022</span></div>&bull;<div class="flex gap-x-1"><span>3 min </span>read</div></div></div><div class="prose"><p>While developing many of my projects I've found myself faced with the timeless question: to document or not to document? My goal is to provide <a href="https://en.wikipedia.org/wiki/Man_page">man pages</a> for any project used from the command-line or designed to be integrated into a larger Linux ecosystem. And so, at the onset of my open-source journey, I stood at a crossroad: learn the unwieldy <a href="https://en.wikipedia.org/wiki/Troff">troff</a> format of man pages or set up a process to build them from an alternative markup format.</p><p>This is an excerpt from the <code>time</code> command's man page written in <code>troff</code>:</p><pre class="language-txt"><code class="language-txt">.TH TIME 1 2019-03-06 "" "Linux User's Manual"<br>.SH NAME<br>time \- time a simple command or give resource usage<br>.SH SYNOPSIS<br>.B time \c<br>.RI [ options ] " command " [ arguments... ]<br>.SH DESCRIPTION<br>The<br>.B time<br>command runs the specified program<br>.I command<br>with the given arguments.</code></pre><p>From my perspective, an alternative is <em>necessary</em>. The markup syntax is cryptic and what would be inline markup in other formats requires a newline in <em>troff</em>.</p><p>There are numerous means of generating man pages from assorted markup formats. For example, using:</p><ul><li><em>reStructured text</em> with <a href="https://manpages.debian.org/testing/docutils-common/rst2man.1.en.html"><code>rst2man</code></a>,</li><li><em>AsciiDoc</em> format with <a href="https://docs.asciidoctor.org/asciidoctor/latest/manpage-backend/"><code>AsciiDoc</code></a> itself,</li><li><em>Markdown</em> with <a href="https://spin.atomicobject.com/2015/05/06/man-pages-in-markdown-ronn/"><code>ronn</code></a> or <a href="https://gabmus.org/posts/man_pages_with_markdown_and_pandoc/"><code>pandoc</code></a>,</li><li>or <em>Pod</em> with <a href="https://perldoc.perl.org/pod2man"><code>pod2man</code></a></li></ul><p>to name a few.</p><p>Admittedly, I'd enjoy writing man pages in <em>Markdown</em>, but in approaching the question of an appropriate build pipeline, I decided early on that I'd like to avoid any external depedencies. This eliminates most options, but the <code>pod2man</code> command is available by default in the Linux distributions I've used. With this in mind, Perl's <a href="https://perldoc.perl.org/perlpod"><em>Pod</em></a>, or Plain Old Documentation, is the top contender.</p><p>Here's an example of a <em>Pod</em>-formatted man page from my <a href="https://github.com/jcrd/iniq"><code>iniq</code></a> project:</p><pre class="language-md"><code class="language-md">=head1 NAME<br><br>iniq - INI file reader<br><br>=head1 SYNOPSIS<br><br>B<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iniq</span><span class="token punctuation">></span></span> <span class="token url">[<span class="token content">options</span>] [<span class="token variable">FILE</span>]</span><br><br>With no FILE, read standard input.<br><br>=head1 DESCRIPTION<br><br>iniq is a simple INI file reader for the command line. It queries an INI file<br>based on the path &lt;I<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">></span></span>>&lt;I<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>separator</span><span class="token punctuation">></span></span>>&lt;I<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">></span></span>> and allows use of custom<br>separators in the file and formatting of the output. Sections inherit keys from<br>a special DEFAULT section unless the I<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>-D</span><span class="token punctuation">></span></span> flag is used. See below for examples.<br><br>=head1 OPTIONS<br><br>=over<br><br>=item B<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>-h</span><span class="token punctuation">></span></span><br><br>Show help message.</code></pre><p>Compared to <em>troff</em>, this is both easier to write and to read, which are important qualities in the maintenance of documentation.</p><h2>Converting <code>.pod</code> files to man pages</h2><p>Producing a man page from a <code>.pod</code> file is straightforward using the <code>pod2man</code> command. In most of my projects, this step is part of a <code>Makefile</code>.</p><p>In the case of <code>iniq</code>, these <code>Makefile</code> rules build and install its man page:</p><pre class="language-shell"><code class="language-shell">VERSIONCMD <span class="token operator">=</span> <span class="token function">git</span> describe --dirty --tags --always <span class="token operator"><span class="token file-descriptor important">2</span>></span> /dev/null<br>VERSION :<span class="token operator">=</span> <span class="token variable"><span class="token variable">$(</span>shell <span class="token punctuation">$(</span>VERSIONCMD<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">cat</span> VERSION<span class="token variable">)</span></span><br><br>PREFIX ?<span class="token operator">=</span> /usr/local<br>MANPREFIX ?<span class="token operator">=</span> <span class="token variable"><span class="token variable">$(</span>PREFIX<span class="token variable">)</span></span>/share/man<br>MANPAGE <span class="token operator">=</span> iniq.1<br><br><span class="token variable"><span class="token variable">$(</span>MANPAGE<span class="token variable">)</span></span><span class="token builtin class-name">:</span> man/<span class="token variable"><span class="token variable">$(</span>MANPAGE<span class="token variable">)</span></span>.pod<br>	pod2man -n<span class="token operator">=</span>iniq -c<span class="token operator">=</span>iniq -s<span class="token operator">=</span><span class="token number">1</span> -r<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>VERSION<span class="token variable">)</span></span> $<span class="token operator">&lt;</span> <span class="token variable"><span class="token variable">$(</span>MANPAGE<span class="token variable">)</span></span><br><br>install: <span class="token variable"><span class="token variable">$(</span>MANPAGE<span class="token variable">)</span></span><br>	<span class="token function">mkdir</span> -p <span class="token variable"><span class="token variable">$(</span>DESTDIR<span class="token variable">)</span></span><span class="token variable"><span class="token variable">$(</span>MANPREFIX<span class="token variable">)</span></span>/man1<br>	<span class="token function">cp</span> -p <span class="token variable"><span class="token variable">$(</span>MANPAGE<span class="token variable">)</span></span> <span class="token variable"><span class="token variable">$(</span>DESTDIR<span class="token variable">)</span></span><span class="token variable"><span class="token variable">$(</span>MANPREFIX<span class="token variable">)</span></span>/man1</code></pre><p>The conversion command:</p><pre class="language-shell"><code class="language-shell">pod2man -n<span class="token operator">=</span><span class="token variable">$name</span> -c<span class="token operator">=</span><span class="token variable">$header</span> -s<span class="token operator">=</span><span class="token variable">$section</span> -r<span class="token operator">=</span><span class="token variable">$footer</span> <span class="token variable">$input</span> <span class="token variable">$output</span></code></pre><ul><li>takes the input <code>.pod</code> file as its first positional argument,</li><li>and the output file name as its second;</li><li>the <code>-n</code> flag sets the man page name,</li><li>the <code>-c</code> flag sets the page header,</li><li>the <code>-s</code> flag sets the section, which should match the output file's extension,</li><li>the <code>-r</code> flag sets the page footer, which in my projects is always the version.</li></ul><h2>More information</h2><p>Descriptions of <code>pod2man</code>'s various options can be found <a href="https://perldoc.perl.org/pod2man">here</a> or in its man page using <code>man pod2man</code>; and with that we've come full circle!</p></div></article></div></div></main><footer class="flex gap-x-1 py-10"><p class="text-gray-500">&nbsp;&copy; 2022</p><a class="hover:underline" href="https://twiddlingbits.net/">James Reed</a></footer></body></html>